Ecoroof Analysis by Alex Vijay Bans 

Introduction

  This project serves to be a reproducable data analysis of my Master's thesis, where the results are compiled in an interactive dashboard. For the full details of the project, including background research, sampling methods, etc. please download the Thesis at https://pdxscholar.library.pdx.edu/open_access_etds/5577/. 
  
  The goal of this particular analysis was to compare the stormwater hydrology and chemistry of a seven-year-old ecoroof on top of a commercial building in high frequency and display the results in an interactive dashboard for interested parties and stakeholders. Potential future additions to this project will add a QA/QC of all data, the addition of bulk deposition and environmental data (such as temperature and wind speed), and statistical analysis. 
  
Methods

	This project uses the following libraries: Tidyverse, Janitor, Fedmatch, Lubridate, and bansr. Dependencies were managed with Renv (see project .lock file).

	All data first had to be uploaded and tidied in a form to be able to be processed. All data was filtered by the start (09/01/2018) and end (06/01/2019) dates of the project. Additionally, the month of October was removed due to sensor malfunctioning. 
	
  First, rain data was uploaded, and cleaned before being parsed into discrete storm events (storms). In this project a storm event was defined following the Environmental Protection Agencies definition of a storm event as per 40 CFR 122.21(q)(7)(ii). The definition states a storm event was defined as having at least 2.54 mm of rain, with an interevent period of at least 72 hours from the previously measurable, greater than 2.54 mm rainfall storm event. Parsing the flow from the roofs was difficult as there was a lag between rainfall and discharge. Thus, all data were separated from the start of the first event, to the start of the next event, instead of the start of the first event to the end of the first event. 
	
	Discharges (Q) from the conventional roof and the eco roof were uploaded and cleaned before being combined together.Discharges were then separated into their associated rain events. After, discharges that were less than 0.04 L/s were removed due to instrument error, it would detect standing water as flow at those levels. Roof runoff volume (V) was calculated by integrating Q with respect to time (dt) using the trapazoidal rule (0.5*dt*(Q1+Q2)). 
	
		Stormwater metal and nutrient pollutant runoff samples were uploaded, processed, and commbined together. The runoff samples collected were flow-weight based, meaning they were collected after certain volumes of discharge occurred. This is different than time based samples which are collected in intervals of duration. Flow weighted samples take into account the quantity of discharge. You can thus assume the concentrations sampled at each discrete volume of discharge is representative of the average concentration of that discharged volume of water. For every flow-weighted sample in a storm event, the geometric mean was taken to determine the flow weighted event mean concentration (EMC). The geometric mean was used as it helps estimate the central tendency of the values while taking the interrelatedness of the values. The EMC values were then added to the flow data via joining left joining with the discharge data sets. 
			
			Taking the EMC * V / Surface Area of the roof, at each time interval gives us the mass flux (Pa). Taking the summation of all Pa through all the storms gives us the total unit area load for the sampling period. 
			
			The percent rainfall retention for the sampling period was calculated by first adding all the volume of runoff for both roof catchment sizes for each storm event, subtracting it by the total discharge from both the roofs, dividing it by runoff volume and multiplying it by 100. 